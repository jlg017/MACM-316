
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Assn4</title><meta name="generator" content="MATLAB 9.9"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2021-07-06"><meta name="DC.source" content="Assn4.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><pre class="codeinput"><span class="comment">%---------------------------------Question 1-------------------------------</span>
<span class="comment">%a)</span>
n = 15;
<span class="comment">%random matrix with values in the interval [-1,1]</span>
B = -1 + (1+1)*rand(n);
disp(<span class="string">'Q1a B = '</span>);
disp(B);

<span class="comment">%b) display random orthonormal matrix Q with n &#8805; 10.</span>
[Q, R] = qr(B);
disp(<span class="string">'Q1b Q = '</span>);
disp(Q);
</pre><pre class="codeoutput">Q1a B = 
  Columns 1 through 3

  -0.539118582557422  -0.849170212177961  -0.888468120926750
  -0.588404813972588  -0.669697389327137  -0.350061510693699
  -0.745494229848747  -0.174639138140626  -0.935528424633862
  -0.980818313478267   0.852604212119009  -0.639899782752228
   0.378268507052686   0.310543341172579  -0.773898442374865
   0.317380197711497   0.571130757650680  -0.485346636166428
   0.567007341291642   0.753389844598086  -0.146903206032710
   0.328109008579052   0.263021983543261  -0.706206131498131
  -0.164597670703542   0.872606923575664  -0.388391573761456
  -0.388981745336736  -0.553276988360182   0.494694447767507
   0.890320968257409  -0.579855359267861   0.572831775091088
   0.563900140089340  -0.099875048006710  -0.081512090710414
  -0.336663422268393   0.831501306147108  -0.129255077260260
  -0.657154932547225  -0.050434059911882   0.792414095878895
   0.435269420299066   0.502932661104829  -0.761875811624688

  Columns 4 through 6

  -0.956888476948584  -0.804383541489736  -0.948813174606133
  -0.978785787389943  -0.401030401468722  -0.352323567462052
   0.332284155068813   0.800497139563589  -0.735990144857835
   0.297454473918877  -0.999499232598235   0.927507843671292
   0.956209570991672  -0.588825149529651   0.655244316118333
   0.712615990990025  -0.611399799848498  -0.369591220453370
   0.722911094567343   0.481290981753806  -0.204501024693702
  -0.215809199994430  -0.082638773101926   0.857293880067463
  -0.682772579210025   0.762505879107224   0.443998585991241
   0.895813280259299  -0.771995161945108  -0.269621067120516
   0.044302537732985  -0.252424290626993   0.886086410357561
   0.496721783137965   0.050155703651569  -0.262754534713950
  -0.208163174736512  -0.267988980411700  -0.177950002291443
  -0.809212672529072   0.339534767433021  -0.948899367913925
  -0.563540742496450  -0.624105254204303   0.804009508818737

  Columns 7 through 9

   0.876717364335401   0.639619541621131  -0.785885997214426
  -0.309579697280991   0.789138101605747  -0.134409633838168
  -0.825329460691044  -0.629152858921808  -0.167909650953918
  -0.261256845406921   0.172098655499131  -0.146345695579811
  -0.828041744125965   0.749357125006710  -0.039299970085397
   0.928920725720741   0.476486908696489   0.291644247313617
   0.089465062619420  -0.967164897261830   0.283324731856825
   0.630160712086257   0.633280902018804   0.368817743470175
  -0.277585230427531   0.080239864944034   0.233592267256216
  -0.669670203395366  -0.936152682178033  -0.488963353567967
  -0.819540941655398   0.288525724577653   0.336872227977019
   0.019314257505237   0.056905890287952   0.129431415286711
   0.543393827481954   0.808129043534724   0.152880968009594
  -0.009103428649470  -0.396894516659369  -0.731560516675252
   0.893924023903921  -0.070332011075125  -0.340973128865445

  Columns 10 through 12

  -0.635284004043452   0.819316907727787   0.154412969369448
  -0.391113864536626  -0.903694264396265  -0.488236699345291
  -0.565647921248581   0.476994597299273   0.229403332358297
   0.341796473505962   0.402669646932364   0.503148496605830
   0.924508911967880  -0.159136466687995   0.453238206487582
  -0.403675912704195   0.606875170466386   0.390506705026795
   0.916707499363518   0.927150203894794  -0.742419835293405
  -0.797074734289767   0.866954844262304  -0.833321181563925
  -0.205255329772868  -0.331803609698080  -0.746895243376632
   0.656019344688943  -0.394918588445051   0.568251619409832
   0.586906699415576   0.847611566232751   0.516579158198438
  -0.989766380996759  -0.328267632073018   0.603686349606708
  -0.323297601048592   0.943928003938197  -0.381779505297646
   0.016114902929760   0.413907134564529  -0.676629976860694
   0.323290926808109   0.783094753710140  -0.946848578882214

  Columns 13 through 15

   0.331269684855575  -0.731232997677380  -0.794151522858646
  -0.695034745145603   0.106801440965525   0.211862571431409
  -0.390843088677082  -0.222376180118177  -0.850283544975299
  -0.807501507552945   0.016130801588421   0.946690539108996
  -0.974835753558864  -0.679459859897505  -0.998370175119839
  -0.086401133799867   0.918691994038944   0.952727641917676
  -0.278804514724735  -0.843117039876541  -0.338633329293964
  -0.214442255756298  -0.624203266033681   0.945902288915262
  -0.890884983995422  -0.172425608977463   0.717654098619107
   0.139002158288854   0.379164068773223   0.388624712027180
  -0.752300461534214   0.389468838102021  -0.320342909102134
   0.439518343013774   0.658576798245828   0.538570417093642
  -0.562975602029961   0.164341244175129   0.720800285147346
  -0.068249348682007  -0.692266816201525  -0.532741407018194
   0.803351937382059  -0.631708496603527   0.464558256723642

Q1b Q = 
  Columns 1 through 3

  -0.244767990467963  -0.347842340054696  -0.485781726257124
  -0.267144684968091  -0.268059074481098  -0.209202603331303
  -0.338465655700348  -0.047173219372513  -0.388507344817525
  -0.445306348865617   0.407684233163512  -0.079705173998854
   0.171739623385623   0.120253662263221  -0.338912032305515
   0.144095410029562   0.235686039928942  -0.163107449324308
   0.257429908741377   0.305203030128161  -0.003006360470228
   0.148966452433081   0.101555074540163  -0.310845596953964
  -0.074729831983713   0.385030067486981  -0.032293373777456
  -0.176603595600701  -0.225188673466704   0.176204447368992
   0.404219185393497  -0.285837083729031   0.097742911309973
   0.256019192400161  -0.064994285917943  -0.100647329092583
  -0.152850285630667   0.373795982493217   0.094509732882299
  -0.298358278623353   0.003340319136484   0.410291846623022
   0.197618900119085   0.201562237447202  -0.309538631833004

  Columns 4 through 6

   0.223675770503568  -0.208883684000736  -0.357214620703952
   0.252334557427468  -0.117901355017094   0.000209789363170
  -0.290782858711587   0.589035487275190   0.029762696612460
  -0.210526365879063  -0.396528687629437   0.372204199974352
  -0.330629920791392  -0.135248257035625   0.104577166095390
  -0.207192841449211  -0.231195100283233  -0.488022170499470
  -0.149080528944478   0.203069518954229  -0.305474822582337
   0.153692903386043   0.010589288639389   0.259016541642357
   0.337606907922604   0.283173734198356   0.168457863941821
  -0.481875656845261  -0.296908954490971   0.009202567932774
   0.076365728393425  -0.178963266188430   0.310765302029319
  -0.132978275736785   0.060102125897261  -0.227431580005096
   0.111253501421699  -0.192175764532167  -0.260609260458082
   0.249852121418898   0.011806396586639  -0.279827644770514
   0.338862693506769  -0.290039861087374   0.022040743821861

  Columns 7 through 9

   0.039774376502662  -0.078832401895619   0.124747971742368
  -0.399812077879660   0.119594786274207  -0.501661908936433
  -0.093171829147069  -0.121227222234038  -0.022884959845300
   0.009491633396125  -0.084018817945059  -0.113101777420890
  -0.524527042056318   0.239732941661875   0.516470543045476
   0.084050001428884   0.190573448177564  -0.253467066503530
  -0.178003029710999  -0.434166877485754  -0.308318430202758
   0.394826751882078   0.162529416735348   0.024752138128670
  -0.334208793711965  -0.058810437997919  -0.094744420567602
  -0.047927555079927  -0.378719371398527  -0.072216209134882
  -0.390474219764241   0.001711227188887  -0.222921251173200
  -0.121670435343779   0.062617120737272   0.049904404502692
  -0.125944557055118   0.365833839510261  -0.090751070351616
  -0.250571176764865  -0.126344903226086   0.432862282171616
   0.010799619572969  -0.590264544378006   0.175544036767489

  Columns 10 through 12

   0.117763853980958  -0.209678272573971  -0.269957244988785
   0.008696187602365   0.301659493848623   0.376347401498093
  -0.133887226489890  -0.346400939867911  -0.014085558343651
  -0.133055243605639  -0.127888614322265  -0.253739888995179
   0.241860635506409   0.124965521783799   0.158921186690842
  -0.089556786018397  -0.018121972128883  -0.108678963496715
   0.314772746624097  -0.168559272700653   0.189525131912057
  -0.182291452413343  -0.289888264365101   0.616626863359759
  -0.202917999810648   0.206659275570361  -0.152679719867159
  -0.189429126289693   0.054725233827590   0.339720558771416
  -0.084087895957855  -0.584861848997944  -0.202224494554110
  -0.792584943223310   0.147088850207741  -0.078533047472488
  -0.032464305396040  -0.335345352229743   0.155734046481958
  -0.163168100541805  -0.269663872208689   0.235748150228178
  -0.107698598016213   0.075622168218532   0.045543779927959

  Columns 13 through 15

   0.279782084524549  -0.227695054658951  -0.278662964033201
  -0.099747613384444  -0.041935161878730   0.255346729257365
  -0.243694844687621   0.266457580482350   0.086423737642099
   0.087020343837702  -0.302700595390440   0.267331268641928
   0.061355428169221  -0.011499798149598   0.005533937410429
   0.289131841150237   0.516891639171643   0.289787079968711
   0.126778407269636  -0.433407844278096   0.034922669271932
   0.307573465490389  -0.070958356812671  -0.000361288904980
   0.448651247277223   0.193626401859328  -0.390481643494091
   0.153671363410540   0.204889954464667  -0.442476872522743
   0.054580363891427   0.122371134831752   0.027679315503974
  -0.095299583868072  -0.400450448385069   0.020696327480607
  -0.460158124795221  -0.018995460656108  -0.450503238659484
   0.208372797258027   0.040746902514692   0.368300061789164
  -0.393253342009833   0.258369853059603   0.070205046224367

</pre><pre class="codeinput"><span class="comment">%c)</span>
n = 50;
<span class="comment">%e = epsilon = 10^-8</span>
e = 0.0000001;
eQ = cell(10);

<span class="keyword">for</span> i = 1:100
    A = -1 + (1+1)*rand(n);
    [Q, R] = qr(A);
    eQ{i} = e * Q;
<span class="keyword">end</span>

<span class="comment">%---------------------------------Question 2-------------------------------</span>
<span class="comment">% a)</span>
v = ones(1,n-1);
J = diag(v,1);

<span class="comment">% b)</span>
B = 4*J;
kB = cond(B,2);
eigen_b = eig(B);
disp(<span class="string">'Q2b eigenvalues of A = 4*J:'</span>);
disp(eigen_b);
disp(<span class="string">'Q2b kA:'</span>);
disp(kB);
<span class="keyword">for</span> i = 1:100
    eQi = cell2mat(eQ(i));
    bPerturb = eig(B + eQi);
    plot(bPerturb, <span class="string">'.'</span>);
    hold <span class="string">on</span>
<span class="keyword">end</span>
hold <span class="string">off</span>

<span class="comment">% c)</span>
C = (4*J + 4*J^2);
kC = cond(C,2);
eigen_c = eig(C);
disp(<span class="string">'Q2c eigenvalues of A = 4*J + 4*J^2:'</span>);
disp(eigen_c);
disp(<span class="string">'Q2c kA:'</span>);
disp(kC);
<span class="keyword">for</span> i = 1:100
    eQi = cell2mat(eQ(i));
    cPerturb = eig(C + eQi);
    plot(cPerturb, <span class="string">'.'</span>);
    hold <span class="string">on</span>
<span class="keyword">end</span>
hold <span class="string">off</span>

<span class="comment">%---------------------------------Question 3-------------------------------</span>
<span class="comment">% a)</span>
s = ones(1,n);
s = s *(-2);
S = diag(s);
l = ones(1,n-1);
L = diag(l,-1);
<span class="comment">%Matrices</span>
L = S + L;
S = L + J;
U = J;

<span class="comment">% b) D = A = L^(-1) * U -&gt; code analyzer recommended L\U &gt; inv(L)*U</span>
D = L\U;
eigen_d = eig(D);
disp(<span class="string">'Q3b eigenvalues of A = inv(L)*U:'</span>);
disp(eigen_d);
kD = cond(D,2);
disp(<span class="string">'Q3b kA:'</span>);
disp(kD);
plot(eigen_d, <span class="string">'.'</span>);

<span class="comment">% c)</span>
<span class="keyword">for</span> i = 1:100
    eQi = cell2mat(eQ(i));
    dPerturb = eig(D + eQi);
    plot(dPerturb, <span class="string">'.'</span>);
    hold <span class="string">on</span>
<span class="keyword">end</span>
hold <span class="string">off</span>

<span class="comment">%---------------------------------Question 4-------------------------------</span>
<span class="comment">% a)</span>
r = linspace(-2,2,n);
p = poly(r);

<span class="comment">% b) F = A = companion matrix to p</span>
F = compan(p);

<span class="comment">% c)</span>
eigen_f = eig(F);
disp(<span class="string">'Q4c Compare roots r with eigenvalues of A'</span>);
disp(abs(r' - eigen_f));
kF = cond(F,2);
disp(<span class="string">'Q4c kA:'</span>);
disp(kF);

<span class="keyword">for</span> i = 1:100
    eQi = cell2mat(eQ(i));
    fPerturb = eig(F+ eQi);
    plot(fPerturb, <span class="string">'.'</span>);
    hold <span class="string">on</span>
<span class="keyword">end</span>
hold <span class="string">off</span>

<span class="comment">% d)</span>
M = 2*rand(n) - 1;
[W,R] = qr(M);
<span class="comment">%G = Matrix B as per question</span>
G = W*diag(r)*W';
eigen_g = eig(G);
disp(<span class="string">'Q4d eigenvalues of B:'</span>);
disp(eigen_g);
gPer_eig = cell(10);
g2Per_eig = cell(10);
<span class="comment">%calculate eigenvalues using 10 perturbation matrices</span>
<span class="keyword">for</span> i = 1:10
    eQi = cell2mat(eQ(i));
    eQiT = eQi';
    gPerturb = eig(G + eQi);
    gPer_eig{i} = gPerturb;
    g2Perturb = eig(G + (eQi + eQiT));
    g2Per_eig{i} = g2Perturb;
    msg = [<span class="string">'Q4d eigenvalues of B + eQ{'</span>,num2str(i),<span class="string">'} vs eigenvalues of B + (e(Q{'</span>,num2str(i),<span class="string">'} + transpose(Q{'</span>,num2str(i),<span class="string">'}))):'</span>];
    disp(msg);
    disp([gPerturb g2Perturb]);
    disp(<span class="string">'Q4d difference:'</span>);
    disp(abs(eigen_g - gPerturb));
<span class="keyword">end</span>

<span class="comment">%compare eigenvalues of A and B</span>
diff = abs(eigen_f - eigen_g);
disp(<span class="string">'Q4d difference between eigenvalues of A vs B'</span>);
disp(diff);
</pre><pre class="codeoutput">Q2b eigenvalues of A = 4*J:
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0

Q2b kA:
   Inf

Q2c eigenvalues of A = 4*J + 4*J^2:
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0

Q2c kA:
   Inf

Q3b eigenvalues of A = inv(L)*U:
  0.000000000000000 + 0.000000000000000i
 -0.996210254835969 + 0.000000000000000i
 -0.984898468017507 + 0.000000000000000i
 -0.966236114702179 + 0.000000000000000i
 -0.940506097142895 + 0.000000000000000i
 -0.908098456178110 + 0.000000000000000i
 -0.869504458610331 + 0.000000000000000i
 -0.825309150102121 + 0.000000000000000i
 -0.776182486480254 + 0.000000000000000i
 -0.722869177888269 + 0.000000000000000i
 -0.666177399739831 + 0.000000000000000i
 -0.606966541603249 + 0.000000000000000i
 -0.546134179731656 + 0.000000000000000i
 -0.484602470721950 + 0.000000000000000i
 -0.423304172559931 + 0.000000000000000i
 -0.363168504954798 + 0.000000000000000i
 -0.305107063676543 + 0.000000000000000i
 -0.250000012407144 + 0.000000000000000i
 -0.198681550224604 + 0.000000000000000i
  0.091096165653489 + 0.010634300940862i
  0.091096165653489 - 0.010634300940862i
  0.086591818557061 + 0.031507673469357i
  0.086591818557061 - 0.031507673469357i
  0.077651947484800 + 0.051173602102078i
  0.077651947484800 - 0.051173602102078i
  0.064452586036997 + 0.068777237951678i
  0.064452586036997 - 0.068777237951678i
  0.047316213327945 + 0.083430740818259i
  0.047316213327945 - 0.083430740818259i
  0.026748609142385 + 0.094232549365902i
  0.026748609142385 - 0.094232549365902i
  0.003481012504743 + 0.100310318611005i
  0.003481012504743 - 0.100310318611005i
 -0.021516729403049 + 0.100890626059258i
 -0.021516729403049 - 0.100890626059258i
 -0.047058563252155 + 0.095340572862732i
 -0.047058563252155 - 0.095340572862732i
 -0.071724910249610 + 0.083143033224532i
 -0.071724910249610 - 0.083143033224532i
 -0.151749858425282 + 0.000000000000000i
 -0.093695033914112 + 0.063803889326908i
 -0.093695033914112 - 0.063803889326908i
 -0.110269933991991 + 0.036084842419385i
 -0.110269933991991 - 0.036084842419385i
 -0.123446260495991 + 0.000000000000000i
 -0.101770316165253 + 0.015765580355111i
 -0.101770316165253 - 0.015765580355111i
 -0.039005528775024 + 0.000000000000000i
 -0.004447524188880 + 0.000000000000000i
  0.000000000000000 + 0.000000000000000i

Q3b kA:
   Inf

Q4c Compare roots r with eigenvalues of A
   0.004351310840844
   0.051088574802652
   0.087728921363232
   0.128593155509429
   0.153008375049565
   3.591836768847293
   0.183727737115036
   0.224291478605064
   3.265305790447939
   0.209492967228379
   0.262216678130524
   2.938776969852465
   2.775506353071568
   2.612251737151824
   0.366735334901145
   0.442683122872669
   2.285705512310709
   2.122457681675451
   1.959176347351033
   1.795924175203198
   1.632648592515281
   0.747672173721521
   0.828702093310253
   1.306125559007657
   1.142855345924417
   0.979592657352674
   1.003892618456730
   1.085493881631468
   0.653060934178334
   0.489795997636999
   0.326530595337555
   1.302176382293266
   1.306682202279317
   0.000000002941498
   1.387703393162106
   0.244897959645128
   1.469391307194364
   0.489795918292062
   1.551020234389608
   0.734693877564491
   1.632653065982262
   0.979591836732816
   1.714285714325751
   1.224489795918221
   1.795918367341316
   1.469387755102160
   1.877551020408235
   1.714285714285705
   1.959183673469387
   1.959183673469388

Q4c kA:
     1.010603436684278e+21

Q4d eigenvalues of B:
   2.000000000000000
   1.918367346938779
   1.836734693877554
  -1.999999999999997
   1.755102040816322
  -1.918367346938775
   1.673469387755100
  -1.836734693877545
   1.591836734693878
   1.510204081632655
  -1.755102040816325
   1.428571428571428
  -1.673469387755096
  -1.591836734693882
   1.346938775510207
  -1.510204081632654
  -1.428571428571432
   1.265306122448980
   1.183673469387758
   1.102040816326531
  -1.346938775510200
  -1.265306122448981
   1.020408163265309
  -1.183673469387754
   0.938775510204082
   0.857142857142859
  -1.102040816326528
  -1.020408163265305
  -0.938775510204081
   0.775510204081634
  -0.857142857142857
  -0.775510204081636
  -0.693877551020409
  -0.612244897959185
   0.693877551020407
  -0.530612244897959
   0.612244897959184
   0.530612244897959
   0.448979591836735
  -0.448979591836735
  -0.367346938775510
   0.367346938775511
  -0.285714285714286
  -0.204081632653061
  -0.122448979591836
  -0.040816326530612
   0.040816326530612
   0.122448979591837
   0.285714285714285
   0.204081632653061

Q4d eigenvalues of B + eQ{1} vs eigenvalues of B + (e(Q{1} + transpose(Q{1}))):
  -1.999999995228077  -1.999999990456165
   2.000000000791808   2.000000001583647
  -1.918367368435949  -1.918367389933137
   1.918367350824190  -1.836734682386108
  -1.836734688131816   1.918367354709610
   1.836734687557632   1.836734681237725
  -1.755102039922847  -1.755102039029382
   1.755102014361634  -1.673469416052176
   1.673469371475439   1.755101987906956
  -1.673469401903638  -1.591836804553135
   1.591836705463954   1.673469355195780
   1.510204062240345   1.591836676234027
   1.428571415362223  -1.510204060144446
  -1.591836769623506   1.510204042848047
   1.346938784082691  -1.428571449369752
  -1.510204070888544   1.428571402153025
  -1.428571438970584   1.346938792655190
  -1.346938781624938  -1.346938787739661
  -1.265306134532521  -1.265306146616061
   1.265306131935111   1.265306141421222
   1.183673469678719  -1.183673469893508
   1.102040798029768   1.183673469969692
  -1.183673469640626  -1.102040809655058
   1.020408152041767  -1.020408205190619
  -1.102040812990791  -0.938775562140852
  -1.020408184227958   1.102040779733033
  -0.938775536172464   1.020408140818226
   0.938775492932876  -0.857142871360708
   0.857142873740625  -0.775510226334363
  -0.857142864251781   0.938775475661678
  -0.775510215207990  -0.693877600750350
  -0.693877575885384   0.857142890338382
  -0.612244874363466  -0.612244850767749
   0.775510210948517   0.775510217815408
   0.693877548363803   0.693877545707202
  -0.530612277279578  -0.530612309661193
   0.612244882958052   0.612244867956923
   0.530612251118795   0.530612257339643
   0.448979591416859   0.448979590996977
  -0.448979615445840  -0.448979639054946
  -0.367346961927052  -0.367346985078605
   0.367346926916515   0.367346915057523
  -0.285714280783188  -0.285714275852099
  -0.204081641941559  -0.204081651230058
  -0.122448955597107  -0.122448931602372
  -0.040816330775656  -0.040816335020698
   0.040816303853384   0.040816281176148
   0.122448962119455   0.122448944647063
   0.285714266845764   0.285714247977243
   0.204081639445353   0.204081646237647

Q4d difference:
   3.999999995228077
   0.081632653853029
   3.755102062313504
   3.918367350824187
   3.591836728948138
   3.755102034496407
   3.428571427677947
   3.591836708239179
   0.081632636781562
   3.183673483536293
   3.346938746280278
   0.081632633668917
   3.102040803117319
   0.000000034929624
   0.000000008572485
   0.000000010744110
   0.000000010399152
   2.612244904073918
   2.448979603920279
   0.163265315608580
   2.530612245188919
   2.367346920478749
   2.204081632905935
   2.204081621429521
   2.040816323194873
   1.877551041370817
   0.163265280154064
   1.959183656198181
   1.795918383944705
   1.632653068333415
   0.081632641934866
   0.081632628196252
   0.081632676656944
   1.387755108907701
   0.000000002656604
   0.000000032381619
   0.000000015001132
   0.000000006220836
   0.000000000419877
   0.000000023609105
   0.000000023151542
   0.000000011858996
   0.000000004931098
   0.000000009288498
   0.000000023994729
   0.000000004245044
   0.000000022677229
   0.000000017472382
   0.000000018868522
   0.000000006792291

Q4d eigenvalues of B + eQ{2} vs eigenvalues of B + (e(Q{2} + transpose(Q{2}))):
  -2.000000032081395   1.999999991125880
  -1.918367349577694   1.918367373853670
  -1.836734713883180  -2.000000064162803
   1.999999995562937   1.836734649938104
  -1.755102054214948  -1.918367352216629
  -1.673469385096388  -1.836734733888821
   1.918367360396224   1.755102023677947
   1.836734671907816  -1.755102067613581
  -1.591836772695372   1.673469355546477
  -1.510204111711953  -1.673469382437685
   1.755102032247122   1.591836710811062
  -1.428571416593483   1.510204046471459
   1.673469371650786   1.428571428969920
  -1.346938762599096  -1.591836810696857
  -1.265306139607740   1.346938722862374
  -1.183673461242703  -1.510204141791264
   1.591836722752465  -1.428571404615564
  -1.102040824745586  -1.346938749687988
  -1.020408168439214  -1.265306156766509
   1.510204064052052   1.265306105777076
   1.428571428770669   1.183673438850873
   1.346938749186277   1.102040788249273
   1.265306114113021  -1.183673453097653
   1.183673454119312   1.020408191970856
   1.102040802287902  -1.102040833164642
  -0.938775540773584  -1.020408173613140
   1.020408177618080  -0.938775571343102
  -0.857142891240157   0.938775533966004
  -0.775510214495926   0.857142817255458
   0.938775522085036  -0.857142925337461
  -0.693877567403583  -0.775510224910219
   0.857142837199158  -0.693877583786770
  -0.612244922324460  -0.612244946689744
   0.775510201110807   0.775510198139984
   0.693877561266691   0.693877571512984
  -0.530612242840627   0.612244911279880
   0.612244904619536   0.530612218025962
   0.530612231461959   0.448979546546968
   0.448979569191852  -0.530612240783299
  -0.448979617336600  -0.448979642836476
  -0.367346943496338  -0.367346948217147
   0.367346908904354   0.367346879033206
  -0.285714300927686  -0.285714316141090
  -0.204081627979103  -0.204081623305153
  -0.122448977803114  -0.122448976014395
  -0.040816343758067  -0.040816360985512
   0.040816291688839   0.040816256847069
   0.122448980627770   0.122448981663702
   0.285714261690078   0.285714237665869
   0.204081620864953   0.204081609076847

Q4d difference:
   4.000000032081395
   3.836734696516473
   3.673469407760734
   3.999999995562933
   3.510204095031270
   0.244897961842387
   0.244897972641124
   3.673469365785361
   3.183673507389250
   3.020408193344608
   3.510204073063447
   2.857142845164911
   3.346938759405882
   0.244897972094786
   2.612244915117947
   0.326530620389951
   3.020408151323897
   2.367346947194566
   2.204081637826971
   0.408163247725521
   2.775510204280868
   2.612244871635257
   0.244897950847712
   2.367346923507066
   0.163265292083820
   1.795918397916443
   2.122448993944608
   0.163265272025148
   0.163265295708155
   0.163265318003402
   0.163265289739274
   1.632653041280793
   0.081632628695950
   1.387755099069992
   0.000000010246284
   0.000000002057332
   0.000000006660352
   0.000000013436000
   0.000000022644883
   0.000000025499865
   0.000000004720828
   0.000000029871157
   0.000000015213401
   0.000000004673958
   0.000000001788722
   0.000000017227455
   0.000000034841774
   0.000000001035933
   0.000000024024207
   0.000000011788108

Q4d eigenvalues of B + eQ{3} vs eigenvalues of B + (e(Q{3} + transpose(Q{3}))):
   1.999999995125024  -1.999999972144967
  -1.999999986072470   1.999999990250073
   1.918367351173458  -1.918367399475341
   1.836734708128448   1.918367355408145
  -1.918367373207054  -1.836734740762778
   1.755102026728032   1.836734722379354
  -1.836734717320154  -1.755102081478350
   1.673469392540210  -1.673469379734783
  -1.755102061147329   1.755102012639755
  -1.673469383744934   1.673469397325321
   1.591836689404560  -1.591836680746034
  -1.591836707719957   1.591836644115252
   1.510204088211619  -1.510204027442527
  -1.510204054537585   1.510204094790593
   1.428571410288515  -1.428571436413425
  -1.428571432492415  -1.346938771805126
   1.346938784863993  -1.265306155121622
  -1.346938773657657   1.428571392005618
  -1.265306138785300  -1.183673523849842
  -1.183673496618795   1.346938794217780
   1.265306124367941  -1.102040807752121
   1.183673424605264  -1.020408189634294
   1.102040802298761  -0.938775591839262
  -1.102040812039325   1.265306126286902
  -1.020408176449799  -0.857142893501442
   1.020408136074888   1.183673379822776
  -0.938775551021666  -0.775510240880291
   0.938775506352236   1.102040788271004
   0.857142849324164   1.020408108884466
  -0.857142875322145  -0.693877539187510
  -0.775510222480966   0.938775502500398
  -0.693877545103959   0.857142841505476
  -0.612244900771419  -0.612244903583664
   0.775510178770943   0.775510153460256
   0.693877539766031   0.693877528511655
  -0.530612234484997  -0.530612224072047
   0.612244883297199   0.612244868635218
   0.530612236096726   0.530612227295499
   0.448979564719684   0.448979537602635
  -0.448979590977364  -0.448979590118000
  -0.367346946361705  -0.367346953947903
   0.367346916590946   0.367346894406389
  -0.285714282018017  -0.285714278321745
  -0.204081645920530  -0.204081659188003
  -0.122448968844285  -0.122448958096724
  -0.040816347442495  -0.040816368354382
   0.040816310992714   0.040816295454817
   0.122448955803358   0.122448932014878
   0.285714307965398   0.285714330216523
   0.204081641307921   0.204081649962772

Q4d difference:
   0.000000004874976
   3.918367333011248
   0.081632657295903
   3.836734708128445
   3.673469414023375
   3.673469373666807
   3.510204105075254
   3.510204086417755
   3.346938795841207
   3.183673465377589
   3.346938730220884
   3.020408136291385
   3.183673475966715
   0.081632680156297
   0.081632634778308
   0.081632649140239
   2.775510213435425
   2.612244896106637
   2.448979608173057
   2.285714312945326
   2.612244899878140
   2.448979547054244
   0.081632639033452
   0.081632657348429
   1.959183686653881
   0.163265278932029
   0.163265265304862
   1.959183669617542
   1.795918359528245
   1.632653079403779
   0.081632634661890
   0.081632658977677
   0.081632650248990
   1.387755076730128
   0.000000011254376
   0.000000010412962
   0.000000014661985
   0.000000008801233
   0.000000027117051
   0.000000000859371
   0.000000007586195
   0.000000022184565
   0.000000003696269
   0.000000013267468
   0.000000010747552
   0.000000020911883
   0.000000015537899
   0.000000023788479
   0.000000022251113
   0.000000008654860

Q4d eigenvalues of B + eQ{4} vs eigenvalues of B + (e(Q{4} + transpose(Q{4}))):
  -2.000000022905605  -2.000000045811257
  -1.918367339464720   2.000000014165917
  -1.836734688862389  -1.918367331990675
   2.000000007082941   1.918367353877937
  -1.755102040868277  -1.836734683847229
  -1.673469407572014   1.836734662294107
   1.918367350408341   1.755102034647550
   1.836734678085820   1.673469357583373
  -1.591836759923918  -1.755102040920245
  -1.510204117529907   1.591836722960310
   1.755102037731932  -1.673469427388907
  -1.428571449487576   1.510204107334070
   1.673469372669223  -1.591836785153971
  -1.346938785311520   1.428571364333425
  -1.265306111610328  -1.510204153427167
  -1.183673481907070  -1.428571470403731
   1.591836728827080  -1.346938795112846
  -1.102040832508588  -1.265306100771693
  -1.020408167377255   1.346938767909783
   1.510204094483353  -1.183673494426371
   1.428571396452430   1.265306075127306
   1.346938771709996  -1.102040848690653
   1.265306098788141  -1.020408171489209
   1.183673464919454   1.183673460451178
   1.102040814814710  -0.938775474659417
  -0.938775492431744   1.102040813302881
   1.020408170217288   1.020408177169273
  -0.857142859093366  -0.857142861043880
  -0.775510206313114  -0.775510208544601
   0.938775484869643   0.938775459535212
  -0.693877559990911  -0.693877568961418
   0.857142850268586   0.857142843394319
  -0.612244882144766  -0.612244866330356
   0.775510188773047   0.775510173464472
   0.693877555561142   0.693877560101875
  -0.530612232786926  -0.530612220675895
   0.612244885531900   0.612244873104626
   0.530612243817256   0.530612242736557
   0.448979594116483   0.448979596396229
  -0.448979608260587  -0.448979624684431
  -0.367346938954363  -0.367346939133228
   0.367346960609239   0.367346982442974
  -0.285714306869601  -0.285714328024926
  -0.204081652314304  -0.204081671975540
  -0.122448981068744  -0.122448982545640
  -0.040816337354337  -0.040816348178070
   0.040816328441518   0.040816330352427
   0.122448980244908   0.122448980897978
   0.285714281867538   0.285714278020792
   0.204081631642009   0.204081630630954

Q4d difference:
   4.000000022905605
   3.836734686403498
   3.673469382739944
   4.000000007082938
   3.510204081684599
   0.244897939366761
   0.244897962653241
   3.673469371963365
   3.183673494617796
   3.020408199162562
   3.510204078548257
   2.857142878059004
   3.346938760424319
   0.244897949382363
   2.612244887120535
   0.326530599725584
   3.020408157398512
   2.367346954957568
   2.204081636765012
   0.408163278156822
   2.775510171962630
   2.612244894158977
   0.244897935522832
   2.367346934307208
   0.163265304610628
   1.795918349574602
   2.122448986543816
   0.163265304171940
   0.163265303890967
   0.163265280788009
   0.163265297151945
   1.632653054350222
   0.081632668875644
   1.387755086732231
   0.000000004540735
   0.000000012111033
   0.000000012427284
   0.000000001080703
   0.000000002279748
   0.000000016423852
   0.000000000178853
   0.000000021833728
   0.000000021155315
   0.000000019661243
   0.000000001476908
   0.000000010823725
   0.000000001910906
   0.000000000653071
   0.000000003846747
   0.000000001011052

Q4d eigenvalues of B + eQ{5} vs eigenvalues of B + (e(Q{5} + transpose(Q{5}))):
  -2.000000005400205  -2.000000010800419
   1.999999990014549   1.999999980029132
  -1.918367337479677  -1.918367328020607
  -1.836734722738409  -1.836734751599285
   1.918367339757651   1.918367332576556
  -1.755102058561261  -1.755102076306213
   1.836734710364366   1.836734726851183
  -1.673469418702963  -1.673469449650834
   1.755102033812187   1.755102026808071
  -1.591836730482207  -1.591836726270550
   1.673469357182688   1.673469326610277
  -1.510204090958365  -1.510204100284095
   1.591836743702826   1.591836752711783
  -1.428571395801202  -1.428571363030978
  -1.346938778782138  -1.346938782054075
  -1.265306156295870  -1.265306190142765
   1.510204077340800   1.510204073048972
  -1.183673474608843  -1.183673479829920
   1.428571391378604  -1.102040784551353
  -1.102040800438941  -1.020408166364746
   1.346938750490363   1.428571354185797
  -1.020408164815020   1.346938725470533
   1.265306148321253  -0.938775531047878
  -0.938775520625974   1.265306174193521
  -0.857142852960533   1.183673417577044
  -0.775510210528039   1.102040765091173
   1.183673443482396  -0.857142848778215
   1.102040790708847  -0.775510216974449
  -0.693877584000698   1.020408139192229
   1.020408151228767  -0.693877616980989
   0.938775519827776   0.938775529451484
   0.857142841201358   0.857142825259867
  -0.612244890107062  -0.612244882254957
   0.775510195260739   0.775510186439861
   0.693877532010359   0.693877513000307
  -0.530612254743292  -0.530612264588616
   0.612244895861788   0.612244893764388
   0.530612211780730   0.530612178663505
   0.448979565045298   0.448979538253865
  -0.448979596366257  -0.448979600895779
  -0.367346960239887  -0.367346981704259
   0.367346922624759   0.367346906474001
  -0.285714290229395  -0.285714294744509
  -0.204081683029279  -0.204081733405492
  -0.122448955504536  -0.122448931417253
  -0.040816312262429  -0.040816297994227
   0.040816300409006   0.040816274287404
   0.122448950013607   0.122448920435377
   0.285714279071569   0.285714272428865
   0.204081610325555   0.204081587998030

Q4d difference:
   4.000000005400205
   0.081632643075770
   3.755102031357232
   0.163265277261588
   0.163265298941329
   0.163265288377514
   0.163265322609266
   0.163265275174582
   0.163265299118309
   3.102040812114862
   3.428571397999013
   2.938775519529793
   3.265306131457922
   0.163265338892680
   2.693877554292345
   0.244897925336784
   2.938775505912232
   2.448979597057823
   0.244897921990847
   2.204081616765473
   2.693877526000563
   0.244897957633961
   0.244897985055944
   0.244897948761780
   1.795918363164615
   1.632653067670897
   2.285714259808924
   2.122448953974152
   0.244897926203383
   0.244897947147133
   1.795918376970632
   1.632653045282993
   0.081632660913347
   1.387755093219924
   0.000000019010049
   0.000000009845333
   0.000000002097396
   0.000000033117229
   0.000000026791437
   0.000000004529522
   0.000000021464377
   0.000000016150752
   0.000000004515109
   0.000000050376217
   0.000000024087300
   0.000000014268183
   0.000000026121606
   0.000000029578230
   0.000000006642716
   0.000000022327506

Q4d eigenvalues of B + eQ{6} vs eigenvalues of B + (e(Q{6} + transpose(Q{6}))):
  -2.000000004154499   2.000000018793200
  -1.918367351188649  -2.000000008309021
   2.000000009396580   1.918367354343852
  -1.836734687759058   1.836734697739340
   1.918367350641312  -1.918367355438531
   1.836734695808436  -1.836734681640594
  -1.755102058867120   1.755101968978629
   1.755102004897463   1.673469341554141
  -1.673469389298846  -1.755102076917941
   1.673469364654622   1.591836719801178
  -1.591836732480163  -1.673469390842617
   1.591836727247524   1.510204086999939
  -1.510204068216742  -1.591836730266431
   1.510204084316296   1.428571433174052
  -1.428571439879130  -1.510204054800844
  -1.346938789168072  -1.428571451186848
  -1.265306127826637  -1.346938802825950
   1.428571430872732  -1.265306133204319
  -1.183673495374783   1.346938739157026
   1.346938757333605  -1.183673521361813
   1.265306104126076   1.265306085803173
   1.183673468528707  -1.102040791844586
   1.102040805008811  -1.020408208091808
  -1.102040804085552   1.183673467669663
  -1.020408185678560  -0.938775532166623
   1.020408137712786   1.102040793691100
  -0.938775521185349   1.020408112160271
   0.938775487001254  -0.857142874224271
   0.857142825298880  -0.775510155954431
  -0.857142865683566   0.938775463798439
  -0.775510180018023  -0.693877642974483
  -0.693877596997448   0.857142793454916
  -0.612244933527918  -0.612244969096656
   0.775510193671669   0.775510183261703
   0.693877538302865   0.693877525585339
  -0.530612233918144  -0.530612222938330
   0.612244906725356   0.612244915491533
   0.530612244336114   0.530612243774263
   0.448979592628333   0.448979593419926
  -0.448979607293754  -0.448979622750779
  -0.367346947651069  -0.367346956526623
   0.367346928565014   0.367346918354513
  -0.285714279662698  -0.285714273611109
  -0.204081661369586  -0.204081690086119
  -0.122448966497355  -0.122448953402889
  -0.040816340083310  -0.040816353635989
   0.040816322865414   0.040816319200214
   0.122448981279624   0.122448982967413
   0.285714268265113   0.285714250815941
   0.204081620405201   0.204081608157342

Q4d difference:
   4.000000004154499
   3.836734698127427
   0.163265315519025
   0.163265312240939
   0.163265309824990
   3.755102042747211
   3.428571446622220
   3.591836698775007
   3.265306123992723
   0.163265283021967
   0.163265308336161
   0.163265298676096
   0.163265319538354
   3.102040819010178
   2.775510215389337
   0.163265292464581
   0.163265300744795
   0.163265308423752
   2.367346964762540
   0.244897941007074
   2.612244879636275
   2.448979590977688
   0.081632641743502
   0.081632665302203
   1.959183695882642
   0.163265280569927
   0.163265295141179
   1.959183650266559
   1.795918335502961
   1.632653069765201
   0.081632677124834
   0.081632607084188
   0.081632617492491
   1.387755091630853
   0.000000012717542
   0.000000010979814
   0.000000008766172
   0.000000000561845
   0.000000000791598
   0.000000015457018
   0.000000008875559
   0.000000010210497
   0.000000006051587
   0.000000028716525
   0.000000013094482
   0.000000013552698
   0.000000003665198
   0.000000001687787
   0.000000017449172
   0.000000012247860

Q4d eigenvalues of B + eQ{7} vs eigenvalues of B + (e(Q{7} + transpose(Q{7}))):
  -2.000000010827709   1.999999943421809
   1.999999971710885  -2.000000021655444
  -1.918367355771264   1.918367286588447
   1.918367316763609  -1.918367364603773
   1.836734678920895   1.836734663964264
  -1.836734707246349  -1.836734720615130
  -1.755102050760334   1.755101977771919
   1.755102009294126  -1.755102060704348
  -1.673469404700236   1.673469401971068
   1.673469394863070  -1.673469421645386
   1.591836735788847   1.591836736883795
   1.510204057420083  -1.591836752049899
  -1.591836743371890   1.510204033207530
   1.428571413640257  -1.510204047474193
  -1.510204064553425   1.428571398709094
   1.346938761241439  -1.428571450287332
  -1.428571439429376  -1.346938746194605
  -1.346938760852401  -1.265306151184475
  -1.265306136816723   1.346938746972677
   1.265306116514713  -1.183673477380325
   1.183673445189773   1.265306110580479
   1.102040820273392  -1.102040845052922
  -1.183673473384041  -1.020408155576962
   1.020408150901744   1.183673420991786
  -1.102040830689725  -0.938775558690738
  -1.020408159421128   1.102040824220254
  -0.938775534447402   1.020408138538201
   0.938775515339154  -0.857142834207392
   0.857142831185080  -0.775510225473657
  -0.857142845675121   0.938775520474223
  -0.775510214777646  -0.693877612599062
  -0.693877581809734   0.857142805227305
  -0.612244903978139  -0.612244909997086
   0.775510206308262   0.775510208534881
   0.693877561639547   0.693877572258692
   0.612244893769454  -0.530612252894000
   0.530612216828864   0.612244889579728
   0.448979584353073   0.530612188759784
  -0.530612248895972   0.448979576869393
  -0.448979605551815  -0.448979619266893
  -0.367346939220674  -0.367346939665835
   0.367346937507613   0.367346936239720
  -0.285714273230044  -0.285714260745800
  -0.204081646098373  -0.204081659543688
  -0.122448980166186  -0.122448980740547
  -0.040816359909940  -0.040816393289239
   0.040816319035087   0.040816311539552
   0.122448970669446   0.122448961747055
   0.285714265238076   0.285714244761864
   0.204081643331278   0.204081654009496

Q4d difference:
   4.000000010827709
   0.081632624772107
   3.755102049648819
   3.918367316763606
   0.081632638104573
   0.081632639692426
   3.428571438515434
   3.591836703171670
   3.265306139394113
   0.163265313230415
   3.346938776605171
   0.081632628848656
   0.081632644383206
   3.020408148334139
   2.857142840063632
   2.857142842874093
   0.000000010857944
   2.612244883301382
   2.448979606204480
   0.163265300188182
   2.530612220699973
   2.367346942722373
   2.204081636649350
   2.204081620289498
   2.040816340893807
   1.877551016563987
   0.163265281879126
   1.959183678604459
   1.795918341389160
   1.632653049756755
   0.081632642365211
   0.081632622271901
   0.081632647042271
   1.387755104267446
   0.000000010619140
   1.142857138667413
   0.081632681130320
   0.081632660544886
   0.979591840732708
   0.000000013715080
   0.000000000445165
   0.000000001267897
   0.000000012484242
   0.000000013445312
   0.000000000574350
   0.000000033379327
   0.000000007495525
   0.000000008922391
   0.000000020476210
   0.000000010678217

Q4d eigenvalues of B + eQ{8} vs eigenvalues of B + (e(Q{8} + transpose(Q{8}))):
  -2.000000024919220  -2.000000049838461
   1.999999988453666  -1.918367358735767
  -1.918367352837268  -1.836734698411826
   1.918367323653252  -1.755102021373879
   1.836734696174677  -1.673469435415454
  -1.836734696144672   1.999999976907366
   1.755102048632132  -1.591836769501323
  -1.755102031095098  -1.510204149362845
  -1.673469411585272   1.918367300367736
   1.673469381951728   1.836734698471814
  -1.591836752097598   1.755102056447940
   1.591836723000185  -1.428571430034269
   1.510204083105734   1.673469376148375
  -1.510204115497743  -1.346938811051921
   1.428571426446896  -1.265306103508053
  -1.428571429302850  -1.183673524122950
   1.346938758448006   1.591836711306504
  -1.346938793281048  -1.102040822730965
  -1.265306112978511  -1.020408161941899
  -1.183673496755352   1.510204084578839
   1.265306104701526   1.428571424322356
   1.183673482422237   1.346938741385804
   1.102040819323792   1.265306086954075
  -1.102040819528748   1.183673495456724
  -1.020408162603604   1.102040822321060
   1.020408153716816  -0.938775502246866
  -0.938775506225470   1.020408144168330
   0.938775509307883  -0.857142885989810
  -0.857142871566335  -0.775510245276121
  -0.775510224678874   0.938775508411679
   0.857142861434508  -0.693877614215958
  -0.693877582618180   0.857142865726164
  -0.612244889321376  -0.612244880683569
   0.775510181636658   0.775510159191690
   0.693877547178731   0.693877543337056
  -0.530612230987654  -0.530612217077352
   0.612244891171519   0.612244884383873
   0.530612233615457   0.530612222332952
   0.448979579725355   0.448979567613969
  -0.448979610574381  -0.448979629312026
  -0.367346945041414  -0.367346951307308
   0.367346945799249   0.367346952822986
  -0.285714297498931  -0.285714309283574
  -0.204081637457185  -0.204081642261314
  -0.122449003857563  -0.122449028123285
  -0.040816319632930  -0.040816312735256
   0.040816298025510   0.040816269520410
   0.122448967796522   0.122448956001189
   0.285714288719876   0.285714291725479
   0.204081644875966   0.204081657098875

Q4d difference:
   4.000000024919220
   0.081632641514888
   3.755102046714823
   3.918367323653249
   0.081632655358355
   0.081632650794103
   0.081632660877032
   0.081632662782447
   3.265306146279150
   0.163265300319072
   0.163265288718726
   0.163265294428757
   3.183673470860831
   0.081632619196139
   0.081632650936689
   0.081632652329804
   2.775510187019438
   2.612244915730028
   2.448979582366268
   2.285714313081884
   2.612244880211726
   2.448979604871218
   0.081632656058483
   0.081632649859006
   1.959183672807686
   0.163265296573957
   0.163265310101058
   1.959183672573188
   0.081632638637746
   1.551020428760508
   1.714285718577364
   0.081632621463456
   0.081632661699033
   1.387755079595843
   0.000000003841676
   0.000000013910305
   0.000000006787664
   0.000000011282502
   0.000000012111381
   0.000000018737646
   0.000000006265904
   0.000000007023738
   0.000000011784645
   0.000000004804123
   0.000000024265727
   0.000000006897682
   0.000000028505102
   0.000000011795315
   0.000000003005590
   0.000000012222904

Q4d eigenvalues of B + eQ{9} vs eigenvalues of B + (e(Q{9} + transpose(Q{9}))):
  -2.000000036235687  -2.000000072471410
   1.999999976589542   1.999999953179116
  -1.918367362976473  -1.918367379014185
   1.918367370469449   1.918367394000113
   1.836734697874094  -1.836734695828041
  -1.836734694852796  -1.755102043427436
   1.755102021763391  -1.673469439834810
  -1.755102042121874   1.836734701870668
   1.673469379307218  -1.591836759403572
  -1.673469413794951   1.755102002710487
   1.591836750142037  -1.510204130938890
  -1.591836747048720   1.673469370859345
   1.510204077931749  -1.428571428346417
  -1.510204106285769  -1.346938822731902
   1.428571397018153  -1.265306154052048
  -1.428571428458916   1.591836765590224
   1.346938777167010  -1.183673476909829
  -1.346938799121045  -1.102040838379090
  -1.265306138250506  -1.020408164769298
  -1.183673473148785   1.510204074230882
   1.265306123680099   1.428571365464862
   1.183673448412729   1.346938778823824
   1.102040811053220   1.265306124911234
  -1.102040827352809   1.183673427437708
  -1.020408164017298   1.102040805779914
   1.020408175142911  -0.938775510674381
  -0.938775510439237   1.020408187020523
   0.938775501661946  -0.857142885361626
   0.857142854693686  -0.775510183678506
  -0.857142871252238   0.938775493119814
  -0.775510193880064  -0.693877548593513
   0.775510199304457   0.857142852244531
   0.693877545394275  -0.612244951492186
  -0.693877549806956   0.775510194527286
  -0.612244924725683   0.693877539768136
   0.612244883021948  -0.530612267243346
   0.530612239040129   0.612244868084722
  -0.530612256070650   0.530612233182308
   0.448979587221392   0.448979582606054
  -0.448979582549094  -0.448979573261462
  -0.367346919413907  -0.367346900052299
   0.367346924476335   0.367346910177148
  -0.285714309053585  -0.285714332392895
  -0.204081650931966  -0.204081669210865
  -0.122448987511157  -0.122448995430478
  -0.040816315102059  -0.040816303673517
   0.040816325324680   0.040816324118763
   0.122448968163816   0.122448956735785
   0.285714304463190   0.285714323212101
   0.204081620799828   0.204081608946603

Q4d difference:
   4.000000036235687
   0.081632629650764
   3.755102056854027
   3.918367370469445
   0.081632657057772
   0.081632652085978
   0.081632634008291
   0.081632651755671
   0.081632644613340
   3.183673495427606
   3.346938790958362
   3.020408175620148
   3.183673465686846
   0.081632628408113
   0.081632621507946
   0.081632653173738
   2.775510205738442
   2.612244921570025
   2.448979607638263
   2.285714289475316
   2.612244899190299
   2.448979570861710
   0.081632647787911
   0.081632642034946
   1.959183674221380
   0.163265318000052
   0.163265305887291
   1.959183664927251
   1.795918364897767
   1.632653075333873
   0.081632663262792
   1.551020403386093
   1.387755096414685
   0.081632651847771
   1.306122475746090
   1.142857127919907
   0.081632658919055
   1.061224500968609
   0.000000004615343
   0.000000009287642
   0.000000019361603
   0.000000014299176
   0.000000023339299
   0.000000018278905
   0.000000007919321
   0.000000011428553
   0.000000001205933
   0.000000011428021
   0.000000018748904
   0.000000011853234

Q4d eigenvalues of B + eQ{10} vs eigenvalues of B + (e(Q{10} + transpose(Q{10}))):
  -2.000000001445792  -2.000000002891591
  -1.918367364511251   2.000000027148086
  -1.836734701958707  -1.918367382083733
   2.000000013574042  -1.836734710039856
  -1.755102057061767   1.918367334182379
  -1.673469402333813  -1.755102073307215
   1.918367340560572   1.836734662866230
   1.836734678371887  -1.673469416912535
  -1.591836726398914   1.755102022297648
   1.755102031556974  -1.591836718103959
  -1.510204092410530   1.673469378046285
   1.673469382900697  -1.510204103188407
  -1.428571461316238   1.591836707617030
   1.591836721155441  -1.428571494061050
  -1.346938791287821  -1.346938807065450
   1.510204102546690  -1.265306206337316
  -1.265306164393148   1.510204123460742
  -1.183673442712083  -1.183673416036414
  -1.102040805083966  -1.102040793841416
  -1.020408183881717  -1.020408204498151
   1.428571438081781   1.428571447592144
  -0.938775516004286   1.346938697405150
   1.346938736457676  -0.938775521804495
  -0.857142901285482   1.265306065963456
   1.265306094206211   1.183673512613246
   1.183673491000501   1.102040826702975
  -0.775510219353455  -0.857142945428111
   1.102040821514742  -0.775510234625289
  -0.693877571039761   1.020408172593645
   1.020408167929472  -0.693877591059113
   0.938775482163399   0.938775454122702
   0.857142832970974   0.857142808799097
  -0.612244924912174  -0.612244951865166
   0.775510185522708   0.775510166963780
   0.693877539073278   0.693877527126146
  -0.530612251142094  -0.530612257386216
   0.612244885766347   0.612244873573520
   0.530612243968728   0.530612243039501
   0.448979593958121   0.448979596079512
  -0.448979586443071  -0.448979581049407
  -0.367346951247560  -0.367346963719608
   0.367346925145063   0.367346911514617
  -0.285714308243853  -0.285714330773426
  -0.204081634699188  -0.204081636745306
  -0.122448978476746  -0.122448977361663
  -0.040816347767177  -0.040816369003752
   0.040816310715084   0.040816294899555
   0.122448959363262   0.122448939134695
   0.285714279348737   0.285714272983192
   0.204081614895653   0.204081597138228

Q4d difference:
   4.000000001445793
   3.836734711450030
   3.673469395836262
   4.000000013574039
   3.510204097878090
   0.244897944604962
   0.244897952805472
   3.673469372249432
   3.183673461092792
   0.244897949924319
   0.244897948405795
   0.244897954329270
   0.244897926438859
   3.183673455849323
   2.693877566798028
   3.020408184179344
   0.163265264178285
   2.448979565161063
   2.285714274471723
   2.122449000208248
   2.775510213591981
   0.326530606444695
   0.326530573192367
   0.326530568102272
   0.326530584002129
   0.326530633857642
   0.326530596973073
   2.122448984780047
   0.244897939164320
   0.244897963847838
   1.795918339306256
   1.632653037052609
   0.081632626108235
   1.387755083481892
   0.000000011947129
   0.000000006244135
   0.000000012192837
   0.000000000929231
   0.000000002121385
   0.000000005393664
   0.000000012472050
   0.000000013630448
   0.000000022529567
   0.000000002046126
   0.000000001115090
   0.000000021236565
   0.000000015815529
   0.000000020228575
   0.000000006365549
   0.000000017757409

Q4d difference between eigenvalues of A vs B
   4.004351310840844
   3.827400869575948
   3.745775381819846
   0.275457420701154
   3.513852905233246
   3.918367381092190
   3.248864660596076
   0.317538247056879
   0.326530280243857
   2.892466344792633
   0.417790602350520
   0.408164724954507
   3.428567577561358
   3.265312961641625
   2.544077678871118
   0.350009368265663
   3.020399389861733
   0.244906661267287
   0.244890633065316
   0.244903767039932
   2.612240429249971
   0.256473712712454
   2.049898283316076
   2.367350048803575
   0.163263509189722
   0.163266126740427
   0.222902075754583
   0.142355933029562
   1.877550730096700
   0.081632732330875
   1.632653044317147
   0.003946066686329
   0.000559753299723
   1.306122451921091
   1.306070740100880
   1.142857142395688
   1.142860694949466
   0.000000000075286
   0.897959009899813
   0.897959183659999
   0.000000004757772
   0.000000000001878
   0.000000000040036
   0.489795918367493
   0.081632653055602
   0.244897959183555
   0.163265306122521
   0.000000000000009
   0.326530612244897
   0.163265306122449

</pre><img vspace="5" hspace="5" src="Assn4_01.png" alt=""> <p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020b</a><br></p></div><!--
##### SOURCE BEGIN #####
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-Question 1REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
%a)
n = 15;
%random matrix with values in the interval [-1,1]
B = -1 + (1+1)*rand(n);
disp('Q1a B = ');
disp(B);

%b) display random orthonormal matrix Q with n ≥ 10.
[Q, R] = qr(B);
disp('Q1b Q = ');
disp(Q);

%% 
%c)
n = 50;
%e = epsilon = 10^-8
e = 0.0000001;
eQ = cell(10);

for i = 1:100
    A = -1 + (1+1)*rand(n);
    [Q, R] = qr(A);
    eQ{i} = e * Q;
end

%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-Question 2REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
% a)
v = ones(1,n-1);
J = diag(v,1);

% b)
B = 4*J;
kB = cond(B,2);
eigen_b = eig(B);
disp('Q2b eigenvalues of A = 4*J:');
disp(eigen_b);
disp('Q2b kA:');
disp(kB);
for i = 1:100
    eQi = cell2mat(eQ(i));
    bPerturb = eig(B + eQi);
    plot(bPerturb, '.');
    hold on
end
hold off

% c)
C = (4*J + 4*J^2);
kC = cond(C,2);
eigen_c = eig(C);
disp('Q2c eigenvalues of A = 4*J + 4*J^2:');
disp(eigen_c);
disp('Q2c kA:');
disp(kC);
for i = 1:100
    eQi = cell2mat(eQ(i));
    cPerturb = eig(C + eQi);
    plot(cPerturb, '.');
    hold on
end
hold off

%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-Question 3REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
% a)
s = ones(1,n);
s = s *(-2);
S = diag(s);
l = ones(1,n-1);
L = diag(l,-1);
%Matrices
L = S + L;
S = L + J;
U = J;

% b) D = A = L^(-1) * U -> code analyzer recommended L\U > inv(L)*U
D = L\U; 
eigen_d = eig(D);
disp('Q3b eigenvalues of A = inv(L)*U:');
disp(eigen_d);
kD = cond(D,2);
disp('Q3b kA:');
disp(kD);
plot(eigen_d, '.');

% c)
for i = 1:100
    eQi = cell2mat(eQ(i));
    dPerturb = eig(D + eQi);
    plot(dPerturb, '.');
    hold on
end
hold off
 
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-Question 4REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
% a)
r = linspace(-2,2,n);
p = poly(r);

% b) F = A = companion matrix to p
F = compan(p);

% c)
eigen_f = eig(F);
disp('Q4c Compare roots r with eigenvalues of A');
disp(abs(r' - eigen_f));
kF = cond(F,2);
disp('Q4c kA:');
disp(kF);

for i = 1:100
    eQi = cell2mat(eQ(i));
    fPerturb = eig(F+ eQi);
    plot(fPerturb, '.');
    hold on
end
hold off

% d)
M = 2*rand(n) - 1; 
[W,R] = qr(M); 
%G = Matrix B as per question
G = W*diag(r)*W';
eigen_g = eig(G);
disp('Q4d eigenvalues of B:');
disp(eigen_g);
gPer_eig = cell(10);
g2Per_eig = cell(10);
%calculate eigenvalues using 10 perturbation matrices
for i = 1:10
    eQi = cell2mat(eQ(i));
    eQiT = eQi';
    gPerturb = eig(G + eQi);
    gPer_eig{i} = gPerturb;
    g2Perturb = eig(G + (eQi + eQiT));
    g2Per_eig{i} = g2Perturb;
    msg = ['Q4d eigenvalues of B + eQ{',num2str(i),'} vs eigenvalues of B + (e(Q{',num2str(i),'} + transpose(Q{',num2str(i),'}))):'];
    disp(msg);
    disp([gPerturb g2Perturb]);
    disp('Q4d difference:');
    disp(abs(eigen_g - gPerturb));
end

%compare eigenvalues of A and B
diff = abs(eigen_f - eigen_g);
disp('Q4d difference between eigenvalues of A vs B');
disp(diff);


##### SOURCE END #####
--></body></html>